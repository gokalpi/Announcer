function displayAddModal(){operationType="add";$("#add-edit-form")[0].reset();$("#modal-title").text("Yeni Mesaj");$("#modal-save-button").html('<i class="las la-save"><\/i> Ekle');$("#modal-form").modal("show")}function displayEditModal(n){operationType="edit";$("#add-edit-form")[0].reset();$("#modal-title").text("Mesaj Güncelleme");$("#modal-save-button").html('<i class="las la-save"><\/i> Güncelle');fetch(`${uri}/${n}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(n){if(!n.ok)throw Error(`${n.status} status code received.`);return n.json()}).then(function(n){if(n.isSuccessful){let t=n.model;notificationId.value=t.id;notificationContent.value=t.content;notificationSender.value=t.sender;notificationSentTime.value=t.sentTime;notificationGroup.value=t.group;notificationRecipient.value=t.recipient;$("#modal-form").modal("show")}else swal("Mesaj Okuma Hatası",n.message,"error")}).catch(n=>{console.error("Unable to get notification.",n),swal("Mesaj Okuma Hatası",n,"error")})}function save(){const n={id:notificationId.value.trim(),content:notificationContent.value.trim(),senderId:notificationSender.value.trim(),sentTime:notificationSentTime.value.trim(),groupId:notificationGroup.value.trim(),recipientId:notificationRecipient.value.trim()};operationType==="edit"?fetch(`${uri}/${n.id}`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(n){if(!n.ok)throw Error(`${n.status} status code received.`);return n.json()}).then(function(t){t.isSuccessful?($("#add-edit-form")[0].reset(),refreshDatatable(),swal(`${n.id} nolu mesaj güncellenmiştir.`,{icon:"success"})):swal("Mesaj Güncelleme Hatası",t.message,"error")}).catch(n=>{console.error("Unable to update notification.",n),swal("Mesaj Güncelleme Hatası",n,"error")}):fetch(uri,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(n){if(!n.ok)throw Error(`${n.status} status code received.`);return n.json()}).then(function(t){t.isSuccessful?($("#add-edit-form")[0].reset(),refreshDatatable(),swal(`${n.name} mesaj eklenmiştir.`,{icon:"success"})):swal("Mesaj Ekleme Hatası",t.message,"error")}).catch(n=>{console.error("Unable to add notification.",n),swal("Mesaj Ekleme Hatası",n,"error")});$("#modal-form").modal("hide")}function deleteNotification(n){swal({title:"Emin misiniz?",text:`${name} nolu mesajı siliyorsunuz.`,icon:"warning",buttons:!0,dangerMode:!0}).then(t=>{t&&fetch(`${uri}/${n}`,{method:"DELETE"}).then(function(n){if(!n.ok)throw Error(`${n.status} status code received.`);return n.json()}).then(function(t){t.isSuccessful?(refreshDatatable(),swal(`${n} nolu mesaj silinmiştir.`,{icon:"success"})):swal("Mesaj Silme Hatası",t.message,"error")}).catch(n=>{console.error("Unable to delete notification.",n),swal("Mesaj Silme Hatası",n,"error")})})}function refreshDatatable(){notificationsTable.ajax.reload()}var uri="/api/v1/Notifications",notificationsTable,operationType,notificationId=document.getElementById("notification-id"),notificationContent=document.getElementById("notification-content"),notificationSender=document.getElementById("notification-sender"),notificationSentTime=document.getElementById("notification-sent-time"),notificationGroup=document.getElementById("notification-group"),notificationRecipient=document.getElementById("notification-recipient");$(document).ready(function(){notificationsTable=$("#notifications").DataTable({dom:'rt<"row justify-content-between bottom-information"lip><"clear">',language:{url:"/lib/datatables/i18n/Turkish.json"},stateSave:!0,processing:!0,serverSide:!0,ajax:{url:`${uri}/LoadTable`,type:"POST",contentType:"application/json",dataType:"json",data:function(n){return JSON.stringify(n)}},columns:[{data:"id",visible:!1},{data:"content"},{data:"sentTime"},{data:"sender"},{data:"group"},{data:"recipient"},{data:null,orderable:!1,render:function(n){return n.isDeleted?`<span class="btn btn-xs btn-font-sm btn-bold btn-label-danger">Silindi</span>`:`<span class="btn btn-xs btn-font-sm btn-bold btn-label-success">Aktif</span>`}},{data:null,orderable:!1,searchable:!1,render:function(n,t,i){return'<div class="action-buttons">'+`<a class="text-primary" data-toggle="tooltip" title="Güncelle" onclick="displayEditModal('${i.id}')"><i class="las la-pencil-alt la-lg"></i></a>`+`<a class="text-danger ml-2" data-toggle="tooltip" title="Sil" onclick="deleteNotification('${i.id}')"><i class="las la-trash-alt la-lg"></i></a></div>`},width:"75px"}]});$("#search").on("keyup change clear",function(){notificationsTable.search()!==this.value&&(notificationsTable.search(this.value),notificationsTable.columns(6).search($("#status").val()),notificationsTable.draw())});$("#status").on("change",function(){notificationsTable.search($("#search").value);notificationsTable.columns(6).search($(this).val()).draw();notificationsTable.draw()})});